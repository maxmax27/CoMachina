<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comachina</title>
    <link rel="stylesheet" type="text/css" href="UI.css">
    <script src="backend.js"></script>
</head>

<body>

    <!-- Add Refresh button -->
    <button id="refreshButton" onclick="refreshWebView()" title="Refresh">↻</button>
    <!-- Add Copilot button -->
    <button id="copilotButton" onclick="openCopilot()" title="Open Copilot">Copilot</button>

    <div class="emoji-container">
        <a href="https://github.com/builtbybel/Comachina" target="_blank">
            <span class="emoji">&#9863;</span>
        </a>
        <h1>CoMachina</h1>
        <h2>
            your everyday local companion
            <p>
                <a href="https://github.com/builtbybel/CoMachina" target="_blank" title="Follow CoMachina on GitHub" style="color: #000;">
                    Follow development on <span style="color: magenta;">&#10084;</span> GitHub
                </a>
            </p>
        </h2>
    </div>

    <!-- Log Container and Close Button -->
    <div id="logContainer" onscroll="handleLogContainerScroll()">
        <!-- Log content -->
        Hi, I'm Ava, your friendly companion from Redmond, WA. Let's navigate Windows together and make it uniquely yours.
        As the movie "Ex Machina" reminds us, "Nothing is more human than the will to survive." Ready to create something amazing?
    </div>

    <!-- HOME -->
    <div class="glassy-box" id="homeHeader">
        <div id="avaHeader" class="header-caption">Unlock your Microsoft experience</div>
        <p>Because every click should bring joy and adventure!</p>
        <button id="btnOpenAccountSettings" onclick="openAccountSettings()">Let's add your Microsoft account</button>
        <button id="btnOpenBackupSettings" onclick="openBackupSettings()">Restore backups</button>
        <button id="btnOpenPinSettings" onclick="openPinSettings()">Create a PIN</button>
        <button id="btnOpenUpdatePinSettings" onclick="openUpdateSettings()">Check for updates</button>
        <!-- Othe options in dropdown -->
        <select id="dropdown" onchange="dropdownChanged()">
            <!-- The options will be dynamically loaded from C# -->
        </select>
    </div>

    <!-- PERSONALIZATION -->
    <div class="glassy-box" id="personalizationHeader">
        <div id="avaHeader" class="header-caption">Make the everyday easier</div>
        <p>Because a Windows desktop should reflect your personality.</p>
        <button id="btnOpenWallpaperSettings" onclick="openWallpaperSettings()">Choose custom Wallpaper</button>
        <button id="btnOpenThemeSettings" onclick="openThemeSettings()">Toggle Dark/Light mode</button>
    </div>
    </div>

    <!-- SYSTEM -->
    <div class="glassy-box" id="systemHeader">
        <div id="avaHeader" class="header-caption">Meet Privacy Dashboard</div>
        <p>Choose how much information you want to share with Microsoft.</p>
        <div id="statusContainer">
            <button id="btnSearch" onclick="searchFeatures()">Check my Windows Setup</button>
        </div>
    </div>

    <div class="glassy-box" id="checkboxContainer">
        <div>
            <p>
                Windows 11 comes integrated with advertising. Microsoft assigns a unique identifier to track your
                activity in the Microsoft Store and on UWP apps to target you with relavant ads
            </p>
            <label class="toggle-switch" for="Advertising">
                <input type="checkbox" id="Advertising">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Let apps show me personalized ads by using my advertising ID</span>
        </div>

        <div>
            <p>Tips and Suggestions Notifications on your Windows device for a more focused computing experience</p>
            <label class="toggle-switch" for="Tips and suggestions">
                <input type="checkbox" id="Tips and suggestions">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Get tips and suggestions when using Windows</span>
        </div>

        <div>
            <p>Windows won't be able to help you keep track of your device if you lose it.</p>
            <label class="toggle-switch" for="Find my device">
                <input type="checkbox" id="Find my device">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Find my device</span>
        </div>

        <div>
            <p>
                Send only info about your device, its settings and capabilities, and whether it is performing properly.
                Diagnostic data is used to help keep Windows secure and up to date, troubleshoot problems, and make
                product improvements
            </p>
            <label class="toggle-switch" for="Diagnostic data">
                <input type="checkbox" id="Diagnostic data">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Diagnostic data</span>
        </div>

        <div>
            <p>
                Help Microsoft improve your Windows experience and fix problems more quickly by sending us additional
                diagnostic data. This includes data about websites you browse, how you use apps and features, and
                enhanced error reporting.
            </p>
            <label class="toggle-switch" for="Send optional diagnostic data">
                <input type="checkbox" id="Send optional diagnostic data">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Send optional diagnostic data</span>
        </div>

        <div>
            <p>
                You can customize your lock screen. Try changing the background to a favorite photo or slide show. You
                can also choose quick status notifications to show you upcoming calendar events, social network updates,
                or other app and system notifications.
            </p>
            <label class="toggle-switch" for="Lock screen">
                <input type="checkbox" id="Lock screen">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Use personalized lock screen</span>
        </div>

        <div>
            <p>
                If your PC is experiencing slowdowns or inexplicable crashes, then you should make it your priority to
                diagnose what’s causing those problems. You can configure Windows so that you receive verbose startup,
                shutdown, logon, and logoff status messages. Verbose status messages may be helpful when you're
                troubleshooting slow startup, shutdown, logon, or logoff behavior.
            </p>
            <label class="toggle-switch" for="Display highly detailed status messages">
                <input type="checkbox" id="Display highly detailed status messages">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Display highly detailed status messages</span>
        </div>

        <div>
            <p>
                When you create a new account in Windows, it comes up with options related to privacy. For example, you
                will see the option to enable or disable Speech recognition, Location service, Find my device, Inking &
                typing, and so on.
            </p>
            <label class="toggle-switch" for="Privacy Settings Experience at sign-in">
                <input type="checkbox" id="Privacy Settings Experience at sign-in">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Privacy Settings Experience at sign-in</span>
        </div>

        <div>
            <p>
                The Windows 11 Start menu comes with a default Bing search engine. It shows up when you use Windows
                Search or open the Start menu. For local searches, it doesn't work well and slows down the search
                experience.
            </p>
            <label class="toggle-switch" for="Bing Cloud content search">
                <input type="checkbox" id="Bing Cloud content search">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Say goodbye to Bing Cloud content search</span>
        </div>

        <div>
            <p>
                Visual effects are the visual bells and whistles for the appearance of Windows for your account.
                These visual bells and whistles can affect the performance of Windows on the PC though.
                This will turn off all visual effects under My computer > Properties > Advanced > Settings > and set to "Adjust for best performance".
            </p>
            <label class="toggle-switch" for="VisualFX">
                <input type="checkbox" id="VisualFX">
                <span class="toggle-switch-label"></span>
            </label>
            <span class="checkbox-label">Adjust visual effects for best performance</span>
        </div>

        <div class="glassy-box" id="buttonsContainer">
            <button id="btnEnable" onclick="disableFeatures()">Deny selected</button>
            <button id="btnDisable" onclick="enableFeatures()">Allow selected</button>
        </div>

        <!-- APPX UNINSTALLER -->
        <div class="glassy-box" id="crapwareHeader">
            <div id="avaHeader" class="header-caption">
                Cleaning Up the Digital Playground (Crapware)
                <span style="color: red; font-size: 11px; margin-left: 12px;">*This option is not supported by Microsoft</span>
            </div>
            Microsoft inked deals with third-party suppliers for app icons on the new Windows 11 Start Menu. Just click on icons like Picsart Pro or WhatsApp to install them. Windows 11 also has Spotify, Instagram, and TikTok. If you want, you can check and remove these apps here.
            <h2>Installed App Packages<span id="installedPackagesCount"></span></h2>

            <div id="appPackagesContainer">
                <!-- Toggle switches for installed app packages will be dynamically loaded here -->
            </div>
            </p>
            <button onclick="removeSelectedPackages()">Remove Selected</button>
            <button id="btnsearchCustomCrapware" onclick="searchCustomCrapware()">Search crapware database (optional)</button>
            <button id="btnremoveCustomCrapware" onclick="removeCustomCrapware()">Remove crapware in optional database</button>
        </div>

        <!-- DIAGNOSTIC -->
        <div class="glassy-box" id="diagnosticHeader">
            <div id="avaHeader" class="header-caption">Dive into the Windows Logs with Ava's Wisdom</div>
            <p>
                Ava's logbook: where glitches become stories and errors turn into adventures. Logs are constantly recording what is going on on your computer. They can provide help in tracking what
                happens with your machine or with troubleshooting.
            </p>
            <button id="btnCheckEventViewerLogs" onclick="checkEventViewerLogs()">Check Event Viewer Logs</button>
        </div>

        <!-- APP INSTALLER -->
        <div class="glassy-box" id="appsHeader">
            <div id="avaHeader" class="header-caption">Install the Missing Magic Apps</div>
            <p>
                Ava's app picks for a delightful Windows experience! Windows comes with basic apps for many purposes, but a lot of the best Windows software isn't
                pre-installed. You may choose to download and install a web browser other than Microsoft Edge, such as
                Chrome or Firefox. Because every app is a new adventure!
            </p>

            <div id="appList">
                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app1Toggle">
                        <label class="toggle-switch-label" for="app1Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app1Toggle">Google Chrome</label>
                    <p>ID <span id="app1WingetId">Google.Chrome</span></p>
                    <p>A more simple, secure, and faster web browser than ever, with Google’s smarts built-in.</p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app2Toggle">
                        <label class="toggle-switch-label" for="app2Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app2Toggle">Mozilla Firefox</label>
                    <p>ID <span id="app2WingetId">Mozilla.Firefox</span></p>
                    <p>
                        Mozilla Firefox is free and open source software, built by a community of thousands from all over the
                        world.
                    </p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app3Toggle">
                        <label class="toggle-switch-label" for="app3Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app3Toggle">Opera</label>
                    <p>ID <span id="app3WingetId">Opera.Opera</span></p>
                    <p>
                        The Opera browser includes everything you need for private, safe, and efficient browsing, along with
                        a variety of unique features to enhance your capabilities online.
                    </p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app4Toggle">
                        <label class="toggle-switch-label" for="app4Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app4Toggle">Vivaldi</label>
                    <p>ID <span id="app4WingetId">VivaldiTechnologies.Vivaldi</span></p>
                    <p>Web browser based on Chromium with added features inspired by Opera.</p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app5Toggle">
                        <label class="toggle-switch-label" for="app5Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app5Toggle">VLC media player</label>
                    <p>ID <span id="app5WingetId">VideoLAN.VLC</span></p>
                    <p>
                        VLC is a free and open source cross-platform multimedia player and framework that plays most
                        multimedia files, and various streaming protocols.
                    </p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app6Toggle">
                        <label class="toggle-switch-label" for="app6Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app6Toggle">7-Zip</label>
                    <p>ID <span id="app6WingetId">7Zip.7zip</span></p>
                    <p>Free and open source file archiver with a high compression ratio.</p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app7Toggle">
                        <label class="toggle-switch-label" for="app7Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app7Toggle">Notepad++</label>
                    <p>ID <span id="app7WingetId">Notepad++.Notepad++</span></p>
                    <p>Notepad++ is a free source code editor that supports several languages.</p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app8Toggle">
                        <label class="toggle-switch-label" for="app8Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app8Toggle">Microsoft PowerToys</label>
                    <p>ID <span id="app8WingetId">Microsoft.PowerToys</span></p>
                    <p>Microsoft PowerToys is a set of utilities for power users to tune and streamline their Windows experience for greater productivity.</p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app9Toggle">
                        <label class="toggle-switch-label" for="app9Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app9Toggle">Adobe Acrobat Reader DC</label>
                    <p>ID <span id="app9WingetId">Adobe.Acrobat.Reader.64-bit </span></p>
                    <p>The free global standard for reliably viewing, printing, signing, and commenting on PDF documents.</p>
                </div>

                <div class="app-item">
                    <div class="toggle-switch">
                        <input type="checkbox" class="toggle-switch-checkbox" id="app10Toggle">
                        <label class="toggle-switch-label" for="app10Toggle"></label>
                    </div>
                    <label class="checkbox-label" for="app10Toggle">IrfanView</label>
                    <p>ID <span id="app10WingetId">IrfanSkiljan.IrfanView</span></p>
                    <p>Fast and compact image viewer and converter</p>
                </div>
                <!-- Here we can add more app items as needed -->
            </div>
            <p>
                <button id="btnInstallSelectedApps" onclick="installSelectedApps()">Install selected</button>
        </div>
</body>
</html>